---
title: "3d"
author: "Kristian Maras"
date: "2024-03-13"
output: html_document
---

```{r setup, include=FALSE, echo=FALSE}
library(tidyverse)
library(plotly)
source("paths.R")
get_paths()
#Run after building_features.R



#data_type <- "filtered"
data_type <- "imputed"

data <- readRDS(file = here::here(generated_data_path,paste0(data_type,"_aggregate_data.rds")))

# Labels
data <- data  %>% mutate(depth_label = case_when(
  endocardium_scar == 0 & intramural_scar == 0 & epicardial_scar == 0 ~ "NoScar",
  endocardium_scar == 1 ~ "AtLeastEndo",
  endocardium_scar == 0 & intramural_scar == 1  ~ "AtLeastIntra",
  endocardium_scar == 0 & intramural_scar == 0 & epicardial_scar == 1 ~ "epiOnly",
  TRUE ~ "Otherwise"
))  %>% select(-c(endocardium_scar,intramural_scar,epicardial_scar))



plot_all_wavefront <- function(select_sheep) {
  data_plot <- data %>% filter(sheep == select_sheep)
  
  fig <- plot_ly(data_plot, x = ~X, y = ~Y, z = ~Z, type = "scatter3d", mode = "markers", marker = list(size = 3),
                  color = ~depth_label, colors = c("red", "blue", "green","black")) %>%
    layout(title = paste0("Sheep",select_sheep))
  
  fig

}

plot_wavefront <- function(select_sheep,select_wavefront) {
  data_plot <- data %>% filter(sheep == select_sheep,WaveFront == select_wavefront)
  
  fig <- plot_ly(data_plot, x = ~X, y = ~Y, z = ~Z, type = "scatter3d", mode = "markers", marker = list(size = 3),
                  color = ~depth_label, colors = c("red", "blue", "green","black")) %>%
    layout(title = paste0("Sheep",select_sheep, "WaveFront ", select_wavefront))
  
  fig

}
```

## 3D Plots of the curated labeles (Ground Truth)



## S18

```{r echo=FALSE}
plot_all_wavefront("S18")
plot_wavefront("S18","RVp")
plot_wavefront("S18","LVp")
plot_wavefront("S18","SR")
```


Can be compared to control sheep

```{r echo=FALSE}
plot_all_wavefront("S20")

```





